*LostArk 시즌1을 추억하며.* 

Python에서 어떻게 Windows API를 호출할 것인가에 대한 기록.

# How to call Windows API

`ctypes` 로 필요한 구조체와 상수 값들을 정의해 나갔다. 처음엔 어떻게 할지 감이 안잡혔지만 금방 익숙해졌다.


# How to fish

낚시 찌를 던지고, 느낌표가 떳냐가 중요했다. 느낌표를 어떻게 인식할 수 있을까에 대한 고민이 필요했다.

1. 스크린샷을 통해 이미지 값을 가져와서, **OpenCV**로 인식하는 방식

   > Screenshot이 구현이 복잡했기에, `screenshot`  이름의 함수로 남겨두었다.

2. 그냥 느낌표가 발생하는 좌표의 픽셀을 가져와서 **RGB값 비교**하는 방식

1번은 너무 느려 물고기를 놓치기 일쑤였기에 2번으로 구현을 했다. 오히려 구현이 쉽고 더 빨라서 좋았다.



# Send a event of key press

`AutoHotpy` 를 통해 편하게 키 입력하려고 했으나 생각대로 되지 않았다. 확인해보니 DirectX로 구현된 경우, 키 맵핑이 다른 것이 원인이였다. 그래서 DirectX의 키 맵핑 테이블을 확인하여 `PostMessageW` 로 직접 구현했다.